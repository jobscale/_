#!/usr/bin/env bash
 set -eu

TYPE="ssh_url"

 getAll() {
  for i in {1..4}
  do
    curl -s "https://api.github.com/users/jobscale/repos?type=all&sort=updated&page=$i" | grep $TYPE | awk -F'"' '{print $4}'
  done
}

LIST=($(getAll))

gitClone() {
  for repo in ${LIST[@]}
  do
    name=$(echo $repo | awk -F'[:/.]' '{print $4}')
    echo -e "\n# $name"
    [[ ! -d $name ]] && git clone $name
    [[ ! -d $name ]] && continue
    cd $name
    git pull
    git-user
    git branch -a | head
    git diff | cat
    cd - > /dev/null
  done
}

gitDiff() {
  for repo in ${LIST[@]}
  do
    name=$(echo $repo | awk -F'[:/.]' '{print $4}')
    echo -e "\n# $name"
    [[ ! -d $name ]] && continue
    cd $name
    git remote set-url origin $repo
    git pull
    git diff | cat
    cd - > /dev/null
  done
}

 grep ^[a-z] $(which $0)
$1
